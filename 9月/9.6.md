## TLS握手过程
面试官：请简述 TLS 1.2 握手过程，特别是客户端和服务端之间往返的通信流程。

TLS 1.2 握手过程通常需要 两个 RTT（往返时间）来完成，主要目的是在不安全的网络上安全地协商出一个对称加密密钥，以便后续通信使用。

第一个 RTT
客户端 -> 服务端：客户端发送 Client Hello 消息。它会告诉服务端自己支持的 TLS 版本、加密套件列表（cipher suites）、以及一个随机数（Client Random）。

服务端 -> 客户端：服务端收到后，从列表中选择一个双方都支持的加密套件，并发送 Server Hello 消息。同时，它会返回自己的随机数（Server Random）和数字证书（Certificate）。这个证书包含了服务端的公钥，用以身份验证和密钥交换。

第二个 RTT
客户端 -> 服务端：客户端验证证书的有效性，然后生成一个预主密钥（pre-master secret）。它使用从服务端证书中获取的公钥加密这个预主密钥，并发送 Client Key Exchange 消息。客户端现在拥有了三个关键信息：Client Random、Server Random 和 pre-master secret。它会利用这三个随机数在本地计算出主密钥（master secret），用于后续对称加密通信。最后，客户端发送 Change Cipher Spec 和 Finished 消息，告知服务端它将开始使用新生成的密钥进行加密通信。

服务端 -> 客户端：服务端收到 Client Key Exchange 消息后，用自己的私钥解密，得到预主密钥。同样，它也拥有那三个关键信息，并计算出和客户端一致的主密钥。最后，服务端也发送 Change Cipher Spec 和 Finished 消息，以确认它也已准备好进行加密通信。

至此，TLS 握手完成。双方都拥有了相同的对称加密密钥，可以安全地进行应用层数据的传输。